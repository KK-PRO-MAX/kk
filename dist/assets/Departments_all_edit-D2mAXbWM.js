import{_ as te,H as le,v as se,r as i,g as ae,o as oe,a as U,c as f,b as c,e as s,d as n,w as a,u as ne,B as de,t as x,F as S,p as V,f as u,x as I,O as ie,n as q,y as w}from"./index-DeY1YHTF.js";import{u as ue}from"./departmentStore-84bdMH_B.js";const re={class:"edit-page"},ce={class:"page-header"},me={class:"page-title"},pe={class:"form-section"},ve={class:"form-section"},fe={class:"section-with-button"},ge={class:"tags-container"},ye={class:"section-with-button"},_e={class:"tags-container"},De={class:"footer-buttons"},ke={class:"card-grid"},be=["onClick"],Be={class:"dialog-footer"},Ce={class:"card-grid"},Ue=["onClick"],xe={class:"dialog-footer"},Se={__name:"Departments_all_edit",setup(Ve){const A=le(),$=se(),D=ue(),g=i(!1),m=i(-1),R=ae(()=>g.value?"Edit Department":"Add New Department"),y=i(""),k=i(""),b=i(!1),B=i(!1),_=i([]),p=i([]),C=i(!1),r=i([]),v=i([]),F=i([{id:"u1",name:"User 1"},{id:"u2",name:"User 2"},{id:"u3",name:"User 3"},{id:"u4",name:"User 4"},{id:"u5",name:"User 5"}]),H=i(Array.from({length:100},(o,e)=>({id:`bay${e+1}`,name:`Bay ${e+1}`})));oe(()=>{const o=A.query.mode;if(g.value=o==="edit",console.log("Route query:",A.query),console.log("History state:",history.state),g.value){m.value=parseInt(A.query.index);let e=history.state.deptData;if(!e&&m.value>=0&&(e=D.departments[m.value],console.log("Loading data from store:",e)),console.log("Edit mode - Department Data:",e),e){if(y.value=e.name||"",k.value=e.description||"",console.log("Loaded name:",y.value),console.log("Loaded description:",k.value),console.log("assignedBays string:",e.assignedBays),e.assignedBays){const d=e.assignedBays.split(",").map(l=>l.trim()).filter(l=>l);console.log("Bay numbers:",d),r.value=d.map(l=>({id:`bay${l}`,name:`Bay ${l}`})),console.log("Loaded Assigned Bays:",r.value)}}else console.warn("No department data found")}});const T=()=>{$.push("/Departments")},j=()=>{if(!y.value.trim()){w.warning("Please enter a department name");return}const o=r.value.map(l=>l.name.replace("Bay ","")).join(", ");let e=null;g.value&&m.value>=0&&(e=D.departments[m.value]);const d={name:y.value.trim(),description:k.value.trim(),assignedBays:o,devices:r.value.length.toString(),locker:(e==null?void 0:e.locker)||"LockerA1",category:(e==null?void 0:e.category)||"A1"};g.value&&m.value>=0?(D.updateDepartment(m.value,d),w.success("Department updated successfully")):(D.addDepartment(d),w.success("Department added successfully")),$.push("/Departments")},z=()=>{b.value=!1,m.value>=0&&(D.deleteDepartment(m.value),w.success("Department deleted successfully")),$.push("/Departments")},O=o=>{const e=_.value.findIndex(d=>d.id===o.id);e>-1&&_.value.splice(e,1)},P=o=>p.value.some(e=>e.id===o.id),G=o=>{const e=p.value.findIndex(d=>d.id===o.id);e>-1?p.value.splice(e,1):p.value.push(o)},J=()=>{_.value=[...p.value],B.value=!1},K=()=>{B.value=!1,p.value=[..._.value]},Q=()=>{p.value=[..._.value],B.value=!0},W=o=>{const e=r.value.findIndex(d=>d.id===o.id);e>-1&&r.value.splice(e,1)},X=o=>v.value.some(e=>e.id===o.id),Y=o=>{const e=v.value.findIndex(d=>d.id===o.id);e>-1?v.value.splice(e,1):v.value.push(o)},Z=()=>{r.value=[...v.value],C.value=!1},h=()=>{C.value=!1,v.value=[...r.value]},ee=()=>{v.value=[...r.value],C.value=!0};return(o,e)=>{const d=U("el-icon"),l=U("el-button"),L=U("el-input"),M=U("el-tag"),N=U("el-dialog");return c(),f("div",re,[s("div",ce,[n(l,{type:"text",class:"back-btn",onClick:T},{default:a(()=>[n(d,null,{default:a(()=>[n(ne(de))]),_:1})]),_:1}),s("h1",me,x(R.value),1),e[7]||(e[7]=s("div",{class:"header-spacer"},null,-1))]),e[23]||(e[23]=s("p",{class:"page-description"},"Assign User to Assigned department.",-1)),s("div",pe,[e[8]||(e[8]=s("label",{class:"form-label"},"Department",-1)),n(L,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),placeholder:"Enter department name",class:"department-name-input"},null,8,["modelValue"])]),s("div",ve,[e[9]||(e[9]=s("label",{class:"form-label"},"Department Description",-1)),n(L,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t),type:"textarea",rows:3,placeholder:"Enter department description",class:"department-description-input"},null,8,["modelValue"])]),s("div",fe,[e[11]||(e[11]=s("label",{class:"form-label"},"User",-1)),s("div",ge,[(c(!0),f(S,null,V(_.value,t=>(c(),I(M,{key:t.id,closable:"",class:"item-tag",onClose:E=>O(t)},{default:a(()=>[u(x(t.name),1)]),_:2},1032,["onClose"]))),128))]),n(l,{type:"primary",class:"add-manage-btn",onClick:Q},{default:a(()=>[...e[10]||(e[10]=[u(" Add Manage ",-1)])]),_:1})]),s("div",ye,[e[13]||(e[13]=s("label",{class:"form-label"},"Assigned Bays",-1)),s("div",_e,[(c(!0),f(S,null,V(r.value,t=>(c(),I(M,{key:t.id,closable:"",class:"item-tag",onClose:E=>W(t)},{default:a(()=>[u(x(t.name),1)]),_:2},1032,["onClose"]))),128))]),n(l,{type:"primary",class:"add-manage-btn",onClick:ee},{default:a(()=>[...e[12]||(e[12]=[u(" Add Manage ",-1)])]),_:1})]),s("div",De,[n(l,{class:"save-btn-bottom",onClick:j},{default:a(()=>[...e[14]||(e[14]=[u("Save",-1)])]),_:1}),g.value?(c(),I(l,{key:0,class:"delete-btn",onClick:e[2]||(e[2]=t=>b.value=!0)},{default:a(()=>[...e[15]||(e[15]=[u("Delete",-1)])]),_:1})):ie("",!0)]),n(N,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=t=>B.value=t),title:"Select Users",width:"700px",color:"#000","close-on-click-modal":!1,"custom-class":"custom-selection-dialog",style:{"font-weight":"600"}},{footer:a(()=>[s("span",Be,[n(l,{type:"default",class:"cancel-btn",onClick:K},{default:a(()=>[...e[16]||(e[16]=[u("Cancel",-1)])]),_:1}),n(l,{type:"primary",class:"save-btn",onClick:J},{default:a(()=>[...e[17]||(e[17]=[u("Save",-1)])]),_:1})])]),default:a(()=>[s("div",ke,[(c(!0),f(S,null,V(F.value,t=>(c(),f("div",{key:t.id,class:q(["selection-card",{selected:P(t)}]),onClick:E=>G(t)},x(t.name),11,be))),128))])]),_:1},8,["modelValue"]),n(N,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=t=>C.value=t),title:"Select Assigned Bays",width:"700px",color:"#000","close-on-click-modal":!1,"custom-class":"custom-selection-dialog",style:{"font-weight":"600"}},{footer:a(()=>[s("span",xe,[n(l,{type:"default",class:"cancel-btn",onClick:h},{default:a(()=>[...e[18]||(e[18]=[u("Cancel",-1)])]),_:1}),n(l,{type:"primary",class:"save-btn",onClick:Z},{default:a(()=>[...e[19]||(e[19]=[u("Save",-1)])]),_:1})])]),default:a(()=>[s("div",Ce,[(c(!0),f(S,null,V(H.value,t=>(c(),f("div",{key:t.id,class:q(["selection-card",{selected:X(t)}]),onClick:E=>Y(t)},x(t.name),11,Ue))),128))])]),_:1},8,["modelValue"]),n(N,{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=t=>b.value=t),title:"Confirm Delete",width:"400px"},{footer:a(()=>[n(l,{onClick:e[5]||(e[5]=t=>b.value=!1)},{default:a(()=>[...e[20]||(e[20]=[u("Cancel",-1)])]),_:1}),n(l,{type:"danger",onClick:z},{default:a(()=>[...e[21]||(e[21]=[u("Delete",-1)])]),_:1})]),default:a(()=>[e[22]||(e[22]=s("p",null,"Are you sure you want to delete this department?",-1))]),_:1},8,["modelValue"])])}}},$e=te(Se,[["__scopeId","data-v-959ff4c9"]]);export{$e as default};
